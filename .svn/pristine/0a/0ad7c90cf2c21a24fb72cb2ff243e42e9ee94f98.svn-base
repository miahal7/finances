$(document).ready(function () {

    $(".date").datepicker();

    $("#new_trans_btn, #next-month-btn, #prev-month-btn").button();

    $("#trans-tab").addClass('active');

    $("#prev-month-btn").click(function(){
        changeMonth($("#prev-month").val(), 'right');
    });

    $("#next-month-btn").click(function () {
        changeMonth($("#next-month").val(), 'left');
    });
});

function changeMonth(ledger_month, direction){

    $.ajax({
        url: 'transactions',
        data: { ledger_date: ledger_month },
        method: "GET",
        success: function(data){
            var slideDistance = (direction == 'left')? -$(window).width() : $(window).width();
            var slideOut = $("#content-inner"); // The div to slide out and hide
            var slideIn = $("#content-inner-2");  // The div to show and slide in

//            $("#content-inner").addClass("hide-old-month");

            if( $("#content-inner").html() == ""){
               slideIn = $("#content-inner");
               slideOut = $("#content-inner-2");
            }


            slideOut.animate({ left: slideDistance }, 500, function() {
                slideOut.html("");
            });

            slideIn.animate({
                left:-slideDistance
            }, 500, function () {
                slideIn.html(data);

                $('table').dataTable({
                    "bJQueryUI":true,
                    "asStripeClasses":[ 'table-odd', 'table-even' ],
                    "aoColumnDefs":[
                        { "sClass":'ui-datepicker-inline', "aTargets":[ 6 ] }
                    ]
                });

                $('.editable').each(function () {
                    $(this).editable('transactions/' + getTransactionId(this), {
                        type:'text',
                        method:'PUT',
                        name:$(this).attr('name'),
                        tooltip:'Click to edit...Enter to save'
                    })
                });

                slideIn.show();
            });

            slideIn.animate({ left: 0}, 500);
        }
    });
}

